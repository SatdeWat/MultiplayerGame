<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <title>Lobby aanmaken</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container center">
    <h2>Kies gamemode & bordgrootte</h2>
    <select id="mode">
      <option value="classic">Classic</option>
      <option value="streak">Streak</option>
      <option value="power">Power</option>
    </select>

    <select id="boardSize">
      <option value="10">10x10 (3 schepen)</option>
      <option value="15">15x15 (4 schepen)</option>
      <option value="20">20x20 (6 schepen)</option>
    </select>

    <button id="createLobby">Maak Lobby</button>
    <p id="lobbyCodeDisplay"></p>
  </div>

  <script type="module">
    import { db, ref, set, onValue } from "./firebase.js";

    const username = localStorage.getItem("username");

    document.getElementById("createLobby").onclick = async () => {
      const code = Math.floor(1000 + Math.random()*9000);
      const mode = document.getElementById("mode").value;
      const size = parseInt(document.getElementById("boardSize").value);

      await set(ref(db, "lobbies/" + code), {
        host: username,
        guest: "",
        mode: mode,
        size: size,
        status: "waiting"
      });

      localStorage.setItem("lobbyCode", code);
      document.getElementById("lobbyCodeDisplay").innerHTML = "ðŸŽ® Lobby Code: <b>" + code + "</b><br>Wachten op speler...";

      onValue(ref(db, "lobbies/" + code), (snap) => {
        if (snap.val().guest && snap.val().status === "waiting") {
          window.location.href = "game.html";
        }
      });
    };
  </script>
</body>
</html>
