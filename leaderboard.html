<!doctype html>
<html lang="nl">
<head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Leaderboard</title><link rel="stylesheet" href="styles.css"></head>
<body>
<main class="wrap">
  <div class="topbar">
    <div><h1>Leaderboard</h1><div class="muted">Top spelers</div></div>
    <div><button onclick="location.href='home.html'" class="ghost">Terug</button></div>
  </div>

  <section class="card">
    <div id="leaderboard" class="leaderboard-list"></div>
  </section>
</main>

<script type="module">
import { db } from "./firebase-config.js";
import { ref, get } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

const lb = document.getElementById('leaderboard');

function medalByIndex(i){
  if (i===0) return "🥇";
  if (i===1) return "🥈";
  if (i===2) return "🥉";
  return "🏅";
}

(async ()=>{
  const usersSnap = await get(ref(db, 'users'));
  const users = usersSnap.exists() ? usersSnap.val() : {};
  const arr = [];
  for (const uid in users){
    const u = users[uid];
    const name = (u.profile && u.profile.username) ? u.profile.username : uid;
    const wins = (u.stats && typeof u.stats.wins !== 'undefined') ? u.stats.wins : 0;
    arr.push({ name, wins, uid });
  }
  arr.sort((a,b)=> b.wins - a.wins);
  lb.innerHTML = '';
  arr.slice(0,100).forEach((x,i)=>{
    const row = document.createElement('div'); row.className='leader-row';
    row.innerHTML = `
      <div class="leader-pos">${medalByIndex(i)}</div>
      <div class="avatar">${x.name.charAt(0).toUpperCase()}</div>
      <div class="leader-name">${x.name}</div>
      <div class="leader-wins">${x.wins}</div>
    `;
    lb.appendChild(row);
  });
})();
</script>
</body>
</html>
