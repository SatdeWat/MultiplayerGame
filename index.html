<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Zeeslag - Inloggen</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="container center">
    <h1>⚓ Zeeslag Online ⚓</h1>
    <input id="username" placeholder="Gebruikersnaam">
    <input id="pincode" type="number" placeholder="Pincode (bijv. 1234)">
    <button id="loginBtn">Login / Registreer</button>
    <button id="guestBtn" class="secondary">Speel als gast</button>
  </div>

  <script type="module">
    import { db, ref, get, set, update } from "./firebase.js";

    document.getElementById('loginBtn').onclick = async () => {
      const name = username.value.trim();
      const pin = pincode.value.trim();
      if (!name || !pin) return alert("Vul alles in!");

      const snap = await get(ref(db, "users/" + name));
      if (snap.exists() && snap.val().pincode != pin) {
        alert("Foute pincode!");
        return;
      }

      await set(ref(db, "users/" + name), {
        pincode: pin,
        wins: snap.exists() ? snap.val().wins || 0 : 0,
        games: snap.exists() ? snap.val().games || 0 : 0
      });

      localStorage.setItem("username", name);
      window.location.href = "home.html";
    };

    guestBtn.onclick = () => {
      localStorage.setItem("username", "Gast" + Math.floor(Math.random()*1000));
      window.location.href = "home.html";
    };
  </script>
</body>
</html>
