<!DOCTYPE html>
<html lang="nl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Zeeslag - Login</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
<div class="login-container">
  <h1>⚓ Zeeslag ⚓</h1>
  <input type="text" id="username" placeholder="Gebruikersnaam">
  <input type="password" id="pincode" placeholder="Pincode (min. 4 cijfers)">
  <div class="button-group">
    <button id="loginBtn">Inloggen</button>
    <button id="registerBtn" class="secondary">Registreren</button>
  </div>
  <p id="message"></p>
</div>

<script type="module">
import { db, ref, get, set } from "./firebase.js";

const usernameInput = document.getElementById("username");
const pincodeInput = document.getElementById("pincode");
const loginBtn = document.getElementById("loginBtn");
const registerBtn = document.getElementById("registerBtn");
const message = document.getElementById("message");

// Registreren
registerBtn.addEventListener("click", async () => {
  const username = usernameInput.value.trim();
  const pincode = pincodeInput.value.trim();
  if (!username || !pincode || pincode.length < 4) { message.textContent="Vul een geldige gebruikersnaam en pincode in!"; return; }
  const snapshot = await get(ref(db, "users/" + username));
  if (snapshot.exists()) { message.textContent="Gebruiker bestaat al!"; return; }
  await set(ref(db, "users/" + username), { pincode, wins:0, games:0 });
  message.style.color="lightgreen";
  message.textContent="Registratie gelukt! Je kunt nu inloggen.";
});

// Inloggen
loginBtn.addEventListener("click", async () => {
  const username = usernameInput.value.trim();
  const pincode = pincodeInput.value.trim();
  if (!username || !pincode) { message.textContent="Vul je gegevens in!"; return; }
  const snapshot = await get(ref(db, "users/" + username));
  if (!snapshot.exists()) { message.textContent="Gebruiker niet gevonden!"; return; }
  if (snapshot.val().pincode === pincode) {
    localStorage.setItem("username", username);
    window.location.href = "home.html";
  } else { message.textContent="❌ Onjuiste pincode!"; }
});
</script>
</body>
</html>
