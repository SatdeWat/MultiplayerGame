<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zeeslag — Login</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="wrap">
    <header class="topbar"><h1>Zeeslag</h1><p class="subtitle">Log in, registreer of speel als gast</p></header>

    <section class="card" id="auth-card">
      <h2>Account</h2>
      <div class="form-grid">
        <label>Gebruikersnaam<input id="username" autocomplete="off"></label>
        <label>Pincode<input id="pincode" type="password" maxlength="8" autocomplete="off"></label>
      </div>
      <div class="row" style="margin-top:10px">
        <button id="btn-register">Registreren</button>
        <button id="btn-login">Inloggen</button>
        <button id="btn-guest">Speel als gast</button>
      </div>
      <div id="auth-status" class="muted" style="margin-top:10px"></div>
    </section>
  </main>

<script type="module">
import { registerUser, loginUser, loginGuest } from "./app-auth.js";
const $ = id => document.getElementById(id);

document.addEventListener('DOMContentLoaded', ()=>{
  const userIn = $('username'), pinIn = $('pincode'), status = $('auth-status');
  $('btn-register').addEventListener('click', async ()=>{
    status.textContent = "Registreren...";
    try {
      const u = userIn.value.trim(), p = pinIn.value.trim();
      if(!u || !p){ status.textContent = "Vul beide velden in"; return; }
      await registerUser(u,p);
      status.textContent = "Geregistreerd — je verschijnt in leaderboard na eerste overwinning. Klik OK om door te gaan.";
      setTimeout(()=> location.href = "home.html", 400);
    } catch(e){ status.textContent = "Registratie mislukt: " + e.message; console.error(e); }
  });

  $('btn-login').addEventListener('click', async ()=>{
    status.textContent = "Inloggen...";
    try {
      const u = userIn.value.trim(), p = pinIn.value.trim();
      if(!u || !p){ status.textContent = "Vul beide velden in"; return; }
      await loginUser(u,p);
      status.textContent = "Ingelogd — door naar home...";
      setTimeout(()=> location.href = "home.html", 250);
    } catch(e){ status.textContent = "Login mislukt: " + e.message; console.error(e); }
  });

  $('btn-guest').addEventListener('click', ()=>{
    loginGuest();
    status.textContent = "Ingelogd als gast — door naar home...";
    setTimeout(()=> location.href = "home.html", 200);
  });

});
</script>
</body>
</html>
