<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Zeeslag — Login</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <main class="wrap">
    <header class="topbar"><h1>Zeeslag</h1><p class="subtitle">Login of speel als gast</p></header>

    <section class="card" id="auth-card">
      <h2>Login / Registreren</h2>
      <div class="form-grid">
        <label>Gebruikersnaam <input id="username" placeholder="gebruikersnaam"></label>
        <label>Pincode <input id="pincode" placeholder="4–8 tekens" type="password" maxlength="8"></label>
      </div>
      <div class="row">
        <button id="btn-register">Registreren</button>
        <button id="btn-login">Inloggen</button>
        <button id="btn-guest">Speel als gast</button>
      </div>
      <div id="auth-status" class="muted" style="margin-top:8px"></div>
    </section>
  </main>

  <script type="module">
    import { registerUser, loginUser, loginGuest } from "./app-auth.js";

    const $ = id => document.getElementById(id);
    const status = $("auth-status");

    $("btn-register").addEventListener("click", async ()=>{
      status.textContent = "Registreren...";
      try {
        const u = $("username").value.trim();
        const p = $("pincode").value.trim();
        await registerUser(u,p);
        status.textContent = "Geregistreerd — doorsturen naar lobby...";
        setTimeout(()=> location.href = "lobby.html", 350);
      } catch(e){ status.textContent = "Fout: " + e.message; console.error(e); }
    });

    $("btn-login").addEventListener("click", async ()=>{
      status.textContent = "Inloggen...";
      try {
        const u = $("username").value.trim();
        const p = $("pincode").value.trim();
        await loginUser(u,p);
        status.textContent = "Ingelogd — doorsturen...";
        setTimeout(()=> location.href = "lobby.html", 250);
      } catch(e){ status.textContent = "Fout: " + e.message; console.error(e); }
    });

    $("btn-guest").addEventListener("click", ()=>{
      loginGuest();
      status.textContent = "Ingelogd als gast — doorsturen...";
      setTimeout(()=> location.href = "lobby.html", 200);
    });
  </script>
</body>
</html>
