<!doctype html> <!-- HTML5 document -->
<html lang="nl"> <!-- taal NL -->
<head>
  <meta charset="utf-8"> <!-- tekenset -->
  <meta name="viewport" content="width=device-width,initial-scale=1"> <!-- mobiel vriendelijk -->
  <title>Zeeslag — Login</title> <!-- titel -->
  <link rel="stylesheet" href="styles.css"> <!-- laad styles -->
</head>
<body>
  <main class="wrap"> <!-- centrale container -->
    <section class="card auth-card"> <!-- login kaart -->
      <h2>Zeeslag — Inloggen / Registreren</h2> <!-- kop -->
      <p class="muted">Maak account met username + pincode (4–8) of speel als gast.</p> <!-- uitleg -->

      <div id="msg" style="display:none;color:#ffb3b3;margin-bottom:8px;"></div> <!-- plek voor meldingen -->

      <div class="form-row"> <!-- username veld -->
        <label for="login-username">Gebruikersnaam</label> <!-- label -->
        <input id="login-username" type="text" placeholder="Naam"> <!-- input -->
      </div>

      <div class="form-row"> <!-- pin veld -->
        <label for="login-pin">Pincode (4-8)</label> <!-- label -->
        <input id="login-pin" type="password" placeholder="1234"> <!-- input -->
      </div>

      <div style="display:flex;gap:8px;flex-wrap:wrap;"> <!-- knoppen -->
        <button id="btn-login">Inloggen</button> <!-- login -->
        <button id="btn-register" class="ghost">Registreren</button> <!-- register -->
        <button id="btn-guest" class="ghost">Speel als gast</button> <!-- gast -->
      </div>

      <p class="muted" style="margin-top:10px">Als je al ingelogd bent wordt je direct doorgestuurd.</p> <!-- hint -->
    </section>
  </main>

  <div id="short-popup"></div> <!-- korte popup element (3s meldingen) -->

  <script type="module">
    // index.html script: regelt inloggen/registratie/gast en redirect naar home.html
    import { tryLogin, tryRegister, playAsGuest, loadLocalProfile } from './app-auth.js'; // import auth helpers

    const $ = id => document.getElementById(id); // helper
    const msg = $('msg'); // melding element

    function showMsg(text, color='red'){ msg.style.display = 'block'; msg.style.color = color; msg.textContent = text; setTimeout(()=> msg.style.display='none', 3000); } // korte melding

    document.addEventListener('DOMContentLoaded', ()=>{ // start als DOM geladen
      const profile = loadLocalProfile(); // check lokaal profiel
      if (profile && profile.uid){ location.href = 'home.html'; return; } // redirect als ingelogd

      $('btn-login').addEventListener('click', async ()=>{ // login klik
        const username = $('login-username').value.trim(); // naam
        const pin = $('login-pin').value.trim(); // pin
        if (!username || !pin) return showMsg('Vul gebruikersnaam en pincode in'); // check
        const res = await tryLogin(username, pin); // probeer login
        if (res.success){ showMsg('Ingelogd...', 'green'); setTimeout(()=> location.href='home.html', 700); } else showMsg(res.message || 'Login mislukt'); // feedback
      });

      $('btn-register').addEventListener('click', async ()=>{ // register klik
        const username = $('login-username').value.trim(); const pin = $('login-pin').value.trim();
        if (!username || !pin) return showMsg('Vul gebruikersnaam en pincode in');
        const res = await tryRegister(username, pin); if (res.success){ showMsg('Geregistreerd!', 'green'); setTimeout(()=> location.href='home.html', 700); } else showMsg(res.message || 'Registratie mislukt');
      });

      $('btn-guest').addEventListener('click', async ()=>{ // gast klik
        await playAsGuest(); showMsg('Je speelt als gast', 'green'); setTimeout(()=> location.href='home.html', 700);
      });
    });
  </script>
</body>
</html>
